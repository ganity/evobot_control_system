# EvoBot控制系统

EvoBot机器人控制系统 - 10自由度机器人手臂PC端调试和控制程序

## 项目概述

这是一个从零开始构建的机器人控制系统，专为EvoBot 10自由度机器人手臂设计。系统采用模块化架构，完全兼容现有的RS-485通信协议，提供丰富的调试和控制功能。

## 主要特性

- ✅ **完全兼容现有协议** - 支持现有的RS-485通信协议和硬件
- ✅ **模块化架构** - 分层设计，易于维护和扩展
- ✅ **多种控制模式** - 手动、轨迹、示教、脚本四种控制模式
- ✅ **平滑轨迹规划** - 支持多种插值算法和速度曲线
- ✅ **实时数据可视化** - 丰富的图表和监控界面
- ✅ **参数调优工具** - 实时参数调整和预设管理
- ✅ **数据记录回放** - 完整的数据记录和分析功能

## 系统架构

```
表示层 (UI)
    ↓
应用层 (业务逻辑)
    ↓
控制层 (运动控制)
    ↓
硬件抽象层 (通信)
    ↓
硬件层 (机器人)
```

## 技术栈

- **编程语言**: Python 3.10+
- **UI框架**: PyQt5
- **数值计算**: NumPy, SciPy
- **数据可视化**: PyQtGraph
- **串口通信**: PySerial
- **配置管理**: PyYAML
- **日志系统**: Loguru

## 安装和运行

### 环境要求

- Python 3.10 或更高版本
- uv 包管理器

### 安装依赖

```bash
# 安装项目依赖
uv sync

# 或者手动安装
uv add PyQt5 pyqtgraph pyserial numpy scipy pyyaml loguru
```

### 运行程序

```bash
# 快速启动（推荐）
python start_evobot.py

# 或使用标准启动
python main.py

# 或使用uv运行
uv run python main.py
```

### 启动优化

系统采用了多项启动优化技术：

- **警告抑制**: 自动抑制第三方库的SyntaxWarning和其他无关警告
- **延迟加载**: 运动学库（roboticstoolbox）采用延迟加载，只在实际使用时才加载
- **模块预加载**: 预加载常用的核心模块以减少导入时间
- **环境优化**: 优化Qt环境设置，减少初始化时间

启动时间对比：
- 优化前：~30-40秒（包含大量警告）
- 优化后：~1-2秒（无警告，延迟加载）

### 开发模式

```bash
# 安装开发依赖
uv add --dev pytest pytest-cov pytest-qt black flake8 mypy

# 运行测试
uv run pytest

# 代码格式化
uv run black src/ tests/

# 类型检查
uv run mypy src/
```

## 项目结构

```
evobot_control_system/
├── src/                          # 源代码目录
│   ├── core/                     # 核心控制模块
│   ├── hardware/                 # 硬件抽象层
│   ├── application/              # 应用层
│   ├── ui/                       # 用户界面
│   ├── utils/                    # 工具模块
│   └── models/                   # 数据模型
├── config/                       # 配置文件目录
├── tests/                        # 测试代码
├── docs/                         # 文档目录
├── logs/                         # 日志文件
├── data/                         # 数据目录
├── main.py                       # 程序入口
├── pyproject.toml               # 项目配置
└── README.md                    # 项目说明
```

## 开发进度

### ✅ 第一阶段：基础框架 (已完成)

- [x] 项目结构搭建
- [x] 配置管理系统
- [x] 日志系统
- [x] 消息总线
- [x] 基础测试框架

### 🚧 第二阶段：硬件通信层 (进行中)

- [ ] 串口管理器
- [ ] 协议编解码器
- [ ] 帧处理器
- [ ] 设备监控器

### ⏳ 第三阶段：运动控制核心 (计划中)

- [ ] 轨迹规划器
- [ ] 插值引擎
- [ ] 运动控制器
- [ ] 安全检查模块

### ⏳ 第四阶段：用户界面 (计划中)

- [ ] 主窗口界面
- [ ] 关节控制面板
- [ ] 状态监控面板
- [ ] 数据可视化

## 配置说明

主要配置文件位于 `config/robot_config.yaml`，包含：

- **机器人配置**: 关节参数、限位设置
- **通信配置**: 串口参数、协议设置
- **控制配置**: 控制频率、轨迹参数
- **安全配置**: 安全限制、保护机制
- **UI配置**: 界面主题、更新频率

## 协议兼容性

系统完全兼容现有的RS-485通信协议：

- **帧格式**: 0xFD + 长度 + 序号 + 类型 + 数据 + 校验 + 0xF8
- **转义机制**: 特殊字符转义处理
- **指令类型**: 位置控制(0x71)、状态查询(0x72)等
- **反馈格式**: 手指状态(0x74)、手臂状态(0x73)

## 贡献指南

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开 Pull Request

## 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 联系方式

- 项目维护者: EvoBot Team
- 邮箱: [your-email@example.com]
- 项目链接: [https://github.com/your-username/evobot-control-system]

## 更新日志

### v1.0.0 (2025-12-22)

- ✅ 完成基础框架搭建
- ✅ 实现配置管理系统
- ✅ 实现日志系统
- ✅ 实现消息总线
- ✅ 建立测试框架

---

**注意**: 这是一个PC端调试程序，不考虑性能限制，追求功能完整性和易用性。